# MQTT-helper
Репозиторий с проектами (front + back) для эмуляции сообщений, отправляемых по топику на MQTT-брокер.

## Структура
Репозиторий состоит из 2-х проектов (папок, частей):
1) backend - проект, в котором реализована подписка и отправление сообщений, получаемых с `frontend`, на MQTT-брокер. 
Также проект `раздаёт` статические файлы, находящиеся в папке `public`, необходимые для отрисовки `web`-интерфейса приложения.
2) frontend - проект, в котором реализована функциональность по отправке необходимых данных (`payload`) на
указанный топик. `frontend` отправляет сообщение на `backend`, который в свою очередь формирует необходимый формат и отправляет их
на подключенный `MQTT-брокер`.

## Начало работы
Для настройки работы приложения необходимо:
1) В `root` папке у файла `.env` задать необходимые параметры или использовать стандартные;
2) Установить зависимости проектов:

```bash
$ npm run install
```

Теперь приложения готовы для использования.

### Варианты использования
Использование возможно в двух вариантах
- `production` режим;
- `development` режим.

___

#### Production
Для запуска необходимо создать билд `front` проекта для раздачи статических страниц `web`-интерфейса и подключения
`backend` к `mqtt`-брокеру.
Билд создаётся при помощи следующей команды:

```bash
$ npm run build
```

После создания билда `frontend` проекта он помещается в папку `backend/public` для статической
раздачи файлов.
Для `production` проект запускается при помощи следующей команды:

```bash
$ npm run start
```

Таким образом запустится `nodejs (express)` сервер на указанном `url` (хост + порт, см. файл `.env`), 
который подключится к `MQTT-брокеру` и будет раздавать страницы `front`-приложения для пользователей.
Для взаимодействия с сервером при помощи `web`-интерфейса необходимо открыть браузер и перейти по `url` (хост + порт).

___

#### Development
Используется внесения изменений в `backend` и/или `frontend` приложения.
Дев режим `backend` приложения запускается следующей командной:

```bash
$ npm run back:dev
```

Дев режим `frontend` приложения запускается следующей командной:

```bash
$ npm run front:start
```

Далее открыть `web`-интерфейс по предложенной в консоли ссылке. 
Таким образом `web`-интерфейс будет "раздавать" не запущенный `backend`, а `dev`-сервер `front`-приложения, который в реальном времени
позволит отслеживать внесённые изменения в код.
